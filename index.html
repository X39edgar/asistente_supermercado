<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>VENANCIO - Asistente en el Súper</title>
  <style>
    body { font-family: Arial, sans-serif; margin:0; padding:0; background:#f9fafb; color:#111827; }
    header { background:#2563eb; color:#fff; padding:20px; text-align:center; }
    header h1 { margin:0; font-size:1.8rem; }
    main { max-width:900px; margin:20px auto; padding:20px; background:#fff; border-radius:12px; box-shadow:0 2px 10px rgba(0,0,0,.1); }
    h2 { color:#2563eb; margin-top:1em; }
    textarea, input, button { width:100%; padding:10px; margin-top:8px; border-radius:8px; border:1px solid #ccc; font-size:1rem; }
    button { background:#10b981; color:white; border:none; cursor:pointer; }
    button:hover { background:#059669; }
    .results { margin-top:15px; padding:10px; background:#f0f9ff; border-radius:8px; }
    .offer-carousel { display:flex; overflow-x:auto; gap:10px; margin-top:10px; }
    .offer { flex:0 0 auto; background:#f59e0b; color:white; padding:15px; border-radius:8px; min-width:150px; text-align:center; }
    .fab, .fab-wa {
      position:fixed; bottom:20px; right:20px; width:56px; height:56px;
      border-radius:50%; display:flex; align-items:center; justify-content:center;
      color:white; font-size:24px; cursor:pointer; box-shadow:0 2px 6px rgba(0,0,0,0.3);
    }
    .fab { background:#2563eb; }
    .fab-wa { background:#25D366; bottom:90px; }
    @media(max-width:600px){ main{margin:10px; padding:15px;} header h1{font-size:1.4rem;} }
  </style>
</head>
<body>
  <header>
    <h1>VENANCIO 🛒 - Tu Asistente en el Súper</h1>
  </header>
  <main>
    <section>
      <h2>📝 Ingresa tu lista</h2>
      <textarea id="lista" rows="4" placeholder="Escribe productos separados por coma o nueva línea"></textarea>
      <button onclick="procesarLista()">Procesar Lista</button>
      <div id="resultado" class="results"></div>
    </section>

    <section>
      <h2>🔥 Ofertas</h2>
      <div class="offer-carousel" id="ofertas"></div>
    </section>

    <section>
      <h2>📇 Déjanos tus datos</h2>
      <form id="leadForm">
        <input type="text" id="nombre" placeholder="Nombre" required />
        <input type="tel" id="telefono" placeholder="Teléfono" />
        <input type="email" id="email" placeholder="Email" />
        <textarea id="mensaje" placeholder="Mensaje"></textarea>
        <button type="submit">Enviar</button>
      </form>
    </section>
  </main>

  <div class="fab" id="btnChat">💬</div>
  <div class="fab-wa" id="btnWA">📱</div>

  <script>
    // Base de datos demo
    const DB = [
      { nombre:"Leche", pasillo:"Lácteos", estante:"A1", precio:25, relacionados:["Cereal","Pan"] },
      { nombre:"Pan", pasillo:"Panadería", estante:"B2", precio:20, relacionados:["Mermelada"] },
      { nombre:"Huevo", pasillo:"Lácteos", estante:"A3", precio:40, relacionados:["Tocino"] },
      { nombre:"Cereal", pasillo:"Despensa", estante:"C1", precio:60, relacionados:["Leche"] },
      { nombre:"Manzana", pasillo:"Frutas", estante:"D1", precio:30, relacionados:["Plátano","Naranja"] }
    ];
    const ofertas = [
      "🍎 Manzanas 2x1", "🥛 10% en leche deslactosada", "🥖 Pan integral -15%", "🥚 2 cartones de huevos por $70"
    ];

    function procesarLista(){
      const texto = document.getElementById("lista").value;
      const productos = texto.split(/,|\n/).map(p=>p.trim()).filter(p=>p);
      let html = "";
      let total = 0;
      productos.forEach(p => {
        const item = DB.find(d=>d.nombre.toLowerCase()===p.toLowerCase());
        if(item){
          total += item.precio;
          html += `✅ ${item.nombre} — ${item.pasillo} (${item.estante}) — $${item.precio}<br>`;
          html += `🤝 Relacionados: ${item.relacionados.join(", ")}<br>`;
        } else {
          html += `⚠️ ${p} — No encontrado<br>`;
        }
      });
      html += `<hr>🧮 Total estimado: <b>$${total}</b>`;
      document.getElementById("resultado").innerHTML = html;
    }

    function cargarOfertas(){
      const cont = document.getElementById("ofertas");
      ofertas.forEach(o=>{
        const div = document.createElement("div");
        div.className="offer";
        div.innerText = o;
        cont.appendChild(div);
      });
    }

    document.getElementById("leadForm").addEventListener("submit", function(e){
      e.preventDefault();
      const data = {
        nombre: document.getElementById("nombre").value,
        telefono: document.getElementById("telefono").value,
        email: document.getElementById("email").value,
        mensaje: document.getElementById("mensaje").value
      };
      window._venancioLead(data);
      e.target.reset();
      alert("¡Datos enviados! ✅");
    });

    window._venancioLead = function(data){
      console.log("Lead capturado:", data);
    };

    document.getElementById("btnWA").addEventListener("click", ()=>{
      const numero = "+5233XXXXXXXX"; // cambia por tu número real
      const msg = encodeURIComponent("Hola, te comparto mi lista de compras 🛒");
      window.open(`https://wa.me/${numero.replace(/[^\d+]/g,"")}?text=${msg}`,"_blank");
    });

    document.getElementById("btnChat").addEventListener("click", ()=>{
      alert("💬 Aquí se abriría el chat de asistencia (Botpress u otro).");
    });

    // Init
    cargarOfertas();
  </script>
</body>
</html>
